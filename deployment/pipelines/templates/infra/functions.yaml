
parameters:
  serviceConnection: ''
  resourceGroup: ''
  functionAppName: ''

steps:
- task: Bash@3
  inputs:
    targetType: 'inline'
    script: 'echo "messaging-functions-odin-mt-poc"' ## <-- follow this example

## TODO -- Get Trigger binding information CLI probally. Event Hub based

## TODO -- Deploy ARM Resource
# - task: AzureResourceGroupDeployment@2
#   displayName: "Deploy Azure Kubernetes Service"
#   inputs:
#     azureSubscription: ${{ parameters.serviceConnection }}
#     action: 'Create Or Update Resource Group'
#     resourceGroupName: ${{ parameters.resourceGroup }}
#     location: 'Central US'
#     templateLocation: 'Linked artifact'
#     csmFile: '$(System.DefaultWorkingDirectory)/deployment/ARM/templates/aks.json'
#     csmParametersFile: '$(System.DefaultWorkingDirectory)/deployment/ARM/parameters/aks.json'
#     overrideParameters: '-resourceName ${{ parameters.aksName }} -dnsPrefix ${{ parameters.aksName }}-dns -servicePrincipalClientId $servicePrincipalId -servicePrincipalClientSecret $servicePrincipalKey'
#     deploymentMode: 'Incremental'
#     addSpnToEnvironment: true

## TODO -- Update App config  for Function uris
# TenantManagerService:twinChangeFunctionUri
# TenantManagerService:telemetryFunctionUri
# TenantManagerService:lifecycleFunctionUri

## TODO -- Deploy ARM Resource -- Deploy Device Properties Function App (talk to Swami)
# - task: AzureResourceGroupDeployment@2
#   displayName: "Deploy Azure Kubernetes Service"
#   inputs:
#     azureSubscription: ${{ parameters.serviceConnection }}
#     action: 'Create Or Update Resource Group'
#     resourceGroupName: ${{ parameters.resourceGroup }}
#     location: 'Central US'
#     templateLocation: 'Linked artifact'
#     csmFile: '$(System.DefaultWorkingDirectory)/deployment/ARM/templates/aks.json'
#     csmParametersFile: '$(System.DefaultWorkingDirectory)/deployment/ARM/parameters/aks.json'
#     overrideParameters: '-resourceName ${{ parameters.aksName }} -dnsPrefix ${{ parameters.aksName }}-dns -servicePrincipalClientId $servicePrincipalId -servicePrincipalClientSecret $servicePrincipalKey'
#     deploymentMode: 'Incremental'
#     addSpnToEnvironment: true